<div class="mdl-card__title"><strong>MetalSlime</strong> posted on 
		
			
				
				Oct 27, 2009 at 1:53:13 AM 
			
			
			
			
		
	</div><div class="mdl-card__supporting-text">
					<span style="font-weight: bold;">Typo</span><br>Glad you got it fixed.&#xA0; Little value errors like that are an annoying problem.&#xA0; I get them all the time too <img src="images/blank.gif" border="0" style="display: none;" original-src="i/expressions/face-icon-small-smile.gif">.&#xA0; One way to avoid this kind of error is to use constants/aliases, which we have been doing for the notes, channels, streams and note lengths.&#xA0; We could make some constants for the different duty cycles:<br><br>duty_0 =&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0; %00110000 ;bottom 4 bits blank, because we will OR with volume<br>duty_25 =&#xA0;&#xA0;&#xA0; &#xA0;&#xA0; %01110000<br>duty_50 =&#xA0;&#xA0;&#xA0; &#xA0;&#xA0; %10110000<br>duty_25_neg = %11110000<br><br>and then in our song files, instead of declaring the duty_vol byte like this:<br><br>.byte %10111111 ;duty 50%, volume F, but I might make a typo!<br><br>we could declare it like this:<br><br>.byte duty_50 | $0F ;the assembler will translate this into %10111111<br><br>At least I think that will work.&#xA0; I think nesasm reads the &quot;|&quot; as a logical OR.<br><br><span style="font-weight: bold;">Sound</span><br>The difference in sound (smooth vs. choppy) is probably the result of turning off the saw envelopes and length counter. The saw envelope is the one built-in volume envelope you get with the hardware.&#xA0; It&apos;s a simple volume-decreasing envelope (down to 0), so when you had it enabled it you probably got some hush on the notes.&#xA0; Enabling the length counter would take control of the note lengths, and the length value that we&apos;ve been feeding to $4003/$4007 would make those notes quite short.&#xA0; That&apos;s my guess as to why you had a choppy sound before. &#xA0;<br><br>When you turned saw envelopes and the length counter off, you basically told the square to give you a constant volume (which you set to F: %xxxx1111) for full-length notes, so the notes will have the same volume for the whole duration of the note.&#xA0; Across several notes this gives a fluid sound.<br><br>If I&apos;m right about the cause of the sound change (hard to know for sure without actually hearing what you mean by &quot;choppy&quot;), we should be able to fix it when we get to volume envelopes, since that is how we will control note volume and length.&#xA0; You will be able to create your own volume envelope that gives you short, quieting notes.<br><br>Next &quot;week&apos;s&quot; lesson is supposed to be opcodes and looping.&#xA0; I was going to try to fit volume envelopes in too if it didn&apos;t get too long, but I was also thinking about splitting it into two lessons.&#xA0; I wasn&apos;t satisfied with the length of the last two lessons (too long).&#xA0; If I do split them, do you have a preference for which topic I cover first (looping vs. volume envelopes)?&#xA0; Maybe it will be easier if I cover volume envelopes first.&#xA0; The tutorials might come faster if I do it that way too.&#xA0; I&apos;ll think about it.
				</div><div class="mdl-card--border"></div>